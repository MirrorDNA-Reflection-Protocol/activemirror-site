<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MirrorMesh â€” Sovereign AI Demo</title>
    <link rel="stylesheet" href="app.css">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/assets/logo.png">
    <script type="module" src="app.js"></script>
</head>

<body>

    <div id="app">

        <!-- VIEW: Model Selection -->
        <div id="view-hero" class="state-view hero-view">
            <div class="hero-logo">âŸ¡</div>
            <h1>Experience Sovereign AI</h1>
            <p>This AI runs entirely in your browser.<br>No cloud. No tracking. Yours forever.</p>

            <div class="model-selector">
                <div class="model-card" data-model="smollm">
                    <div class="card-title">âš¡ Quick</div>
                    <span class="card-meta">SmolLM2 Â· 200MB Â· ~10s</span>
                    <div class="card-desc">Fast answers for simple tasks</div>
                </div>

                <div class="model-card recommended" data-model="llama3">
                    <div class="card-title">âŸ¡ Reflect</div>
                    <span class="card-meta">Llama 3.2 3B Â· 1.8GB Â· ~60s</span>
                    <div class="card-desc">Deep reflection, structured thinking</div>
                </div>

                <div class="model-card" data-model="phi3">
                    <div class="card-title">â—ˆ Reason</div>
                    <span class="card-meta">Phi-3 Mini Â· 2.2GB Â· ~90s</span>
                    <div class="card-desc">Advanced reasoning, complex analysis</div>
                </div>
            </div>

            <div id="webgpu-check">Checking device...</div>
        </div>

        <!-- VIEW: Loading -->
        <div id="view-loading" class="state-view hero-view hidden">
            <div class="hero-logo">âŸ¡</div>
            <h2>Downloading to Your Browser</h2>
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="dl-progress" class="progress-fill"></div>
                </div>
            </div>
            <p id="dl-status">Initializing...</p>
            <p style="font-size:0.8rem; color:var(--text-secondary); margin-top:16px;">
                This only happens once. Model stays on your device.
            </p>
        </div>

        <!-- VIEW: Chat -->
        <div id="view-chat" class="state-view hidden">

            <header class="chat-header">
                <div class="chat-header-left">
                    <button id="toggle-sidebar" class="btn-small">â˜°</button>
                    <div class="chat-header-title">
                        <span class="glyph">âŸ¡</span> MirrorMesh
                    </div>
                </div>
                <div class="status-bar">
                    <span id="stat-latency">âš¡ --</span>
                    <span id="stat-carbon">ğŸŒ± 0g</span>
                    <span class="desktop-only">ğŸ”’ Local</span>
                </div>
            </header>

            <div id="chat-history"></div>

            <div class="chat-input-wrapper">
                <div class="suggestions" id="suggestions">
                    <button class="suggestion" data-prompt="Should I raise VC funding?">VC funding?</button>
                    <button class="suggestion" data-prompt="Help me think through a career change">Career
                        change</button>
                    <button class="suggestion" data-prompt="What makes this different from ChatGPT?">Why this?</button>
                    <button class="suggestion" data-prompt="I have an idea but I'm not sure if it's good">Validate
                        idea</button>
                </div>

                <div class="input-row">
                    <button id="voice-btn" class="voice-btn" title="Voice input">ğŸ¤</button>
                    <textarea id="user-input" placeholder="What's on your mind?" rows="1" disabled></textarea>
                    <button id="send-btn" disabled>â†‘</button>
                </div>

                <div class="input-footer">
                    <label class="toggle">
                        <input type="checkbox" id="red-team-toggle">
                        <span class="toggle-slider"></span>
                        Red Team
                    </label>
                    <div class="action-btns">
                        <button id="export-btn" class="btn-small">Save Mirror</button>
                        <a href="https://id.activemirror.ai" target="_blank" class="btn-small primary">Create Identity
                            â†’</a>
                    </div>
                </div>
            </div>

        </div>

        <!-- Sidebar (Desktop only) -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <span class="glyph">âŸ¡</span> MirrorOS
            </div>
            <div class="sidebar-content">
                <p class="sidebar-label">Vault</p>
                <div id="vault-list">
                    <div class="vault-item">ğŸ“ Sessions</div>
                    <div class="vault-item">ğŸ“ Captures</div>
                </div>
            </div>
            <div class="sidebar-footer">
                <button class="btn-small" style="width:100%">âš™ Settings</button>
            </div>
        </aside>

    </div>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>

</html>